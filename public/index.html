<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Cycle: Reborn - Save Editor Community Edition</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Custom Title Bar -->
    <div class="custom-title-bar">
        <div class="title-bar-title">The Cycle: Reborn - Save Editor Community Edition</div>
        <div class="title-bar-controls" id="title-bar-controls">
            <!-- Window controls will be added by JavaScript if in Electron -->
        </div>
    </div>

    <div class="container">
        <!-- Enhanced Sidebar -->
        <div class="sidebar">
            <h2>NAVIGATION</h2>
            
            <div class="filter-section">
                <h3>Core Features</h3>
                <button class="nav-btn active" data-view="inventory">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19 7h-3V6a4 4 0 0 0-8 0v1H5a1 1 0 0 0-1 1v11a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3V8a1 1 0 0 0-1-1zM10 6a2 2 0 0 1 4 0v1h-4V6zm8 13a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V9h2v1a1 1 0 0 0 2 0V9h4v1a1 1 0 0 0 2 0V9h2v10z"/>
                    </svg>
                    INVENTORY
                </button>
                <button class="nav-btn" data-view="loadout-editor">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2zm0 18a8 8 0 1 1 8-8 8 8 0 0 1-8 8z"/>
                        <path d="M12 6a6 6 0 1 0 6 6 6 6 0 0 0-6-6zm0 10a4 4 0 1 1 4-4 4 4 0 0 1-4 4z"/>
                    </svg>
                    LOADOUT EDITOR
                </button>
                <button class="nav-btn" data-view="faction-editor">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                    </svg>
                    FACTION EDITOR
                </button>
            </div>

            <div class="filter-section">
                <h3>Community Features</h3>
                <button class="nav-btn" data-view="community-inventories">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M16 4h-4V2a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v2H0v2h2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V6h2V4zM6 2h4v2H6V2zm10 18H4V6h12v14z"/>
                        <path d="M6 8h8v2H6zM6 12h8v2H6zM6 16h8v2H6z"/>
                    </svg>
                    COMMUNITY INVENTORIES
                </button>
                <button class="nav-btn" data-view="community-loadouts">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.94-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/>
                    </svg>
                    COMMUNITY LOADOUTS
                </button>
            </div>

            <div class="filter-section">
                <h3>Categories</h3>
                <button class="category-btn active" data-category="all">ALL</button>
                <button class="category-btn" data-category="weapons">WEAPONS</button>
                <button class="category-btn" data-category="ammo">AMMO</button>
                <button class="category-btn" data-category="armor">ARMOR</button>
                <button class="category-btn" data-category="consumables">CONSUMABLES</button>
                <button class="category-btn" data-category="materials">MATERIALS</button>
                <button class="category-btn" data-category="tools">TOOLS</button>
                <button class="category-btn" data-category="attachments">ATTACHMENTS</button>
            </div>

            <div class="filter-section">
                <h3>Actions</h3>
                <button class="filter-btn" id="add-item-btn">Browse Items</button>
                <button class="filter-btn" id="clear-inventory">Clear All</button>
                <button class="filter-btn" id="backup-save">Export Backup</button>
                <button class="filter-btn" id="restore-save">Import Backup</button>
            </div>

            <div class="filter-section">
                <h3>Game</h3>
                <button class="filter-btn" id="launch-game-btn">
                    <span id="launch-game-text">Launch Game</span>
                </button>
                <button class="filter-btn" id="configure-game-btn" style="display: none;">
                    Configure Game Path
                </button>
            </div>

            <div class="filter-section" id="update-section" style="display: none;">
                <h3>Updates</h3>
                <button class="filter-btn btn-update" id="check-updates-btn">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="margin-right: 6px;">
                        <path d="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"/>
                    </svg>
                    Check Updates
                </button>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content" id="main-content">
            <!-- Header -->
            <div class="header">
                <div class="header-left">
                    <h1 id="current-view-title">Inventory Editor</h1>
                </div>
                <div class="header-right">
                    <!-- User Profile (shown when logged in) -->
                    <div class="user-profile" id="user-profile" style="display: none;">
                        <div class="user-avatar" id="user-avatar">U</div>
                        <div class="user-name" id="user-name">Guest</div>
                        <button class="btn btn-danger btn-sm" id="logout-btn">Logout</button>
                    </div>
                    
                    <!-- Login Button (shown when not logged in) -->
                    <button class="btn btn-github" id="login-btn">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                        </svg>
                        Login to Access Community
                    </button>
                </div>

                <!-- Community loadouts content (shown when authenticated) -->
                <div id="community-loadouts-content" style="display: none;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                        <div class="search-container" style="flex: 1; margin-right: 20px; margin-bottom: 0;">
                            <input type="text" class="search-input" id="search-community-loadouts" placeholder="Search community loadouts...">
                        </div>
                        <button class="btn btn-primary" id="upload-loadout-btn">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                            </svg>
                            Upload Loadout
                        </button>
                    </div>

                    <!-- Category filters -->
                    <div class="filter-section" style="margin-bottom: 30px;">
                        <h3>Filter by Category</h3>
                        <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px;">
                            <button class="tag filter-tag active" data-category="all">All</button>
                            <button class="tag filter-tag" data-category="stealth">Stealth</button>
                            <button class="tag filter-tag" data-category="aggressive">Aggressive</button>
                            <button class="tag filter-tag" data-category="support">Support</button>
                            <button class="tag filter-tag" data-category="exploration">Exploration</button>
                            <button class="tag filter-tag" data-category="sniper">Sniper</button>
                            <button class="tag filter-tag" data-category="close-quarters">Close Quarters</button>
                        </div>
                    </div>

                    <!-- Community loadouts grid -->
                    <div class="community-grid" id="community-loadouts-grid">
                        <div class="loading">
                            <div class="spinner"></div>
                            Loading community loadouts...
                        </div>
                    </div>
                </div>
            </div>

            <!-- Faction Editor View -->
            <div id="faction-editor-view" class="view-container">
                <div class="faction-editor">
                    <h2 style="color: #64ffda; text-align: center; margin-bottom: 30px;">Faction Level Editor</h2>
                    <p style="text-align: center; color: #a0aec0; margin-bottom: 40px;">
                        Adjust your reputation levels with each faction. Changes are automatically saved.
                    </p>

                    <div class="faction-grid">
                        <!-- ICA Faction -->
                        <div class="faction-card">
                            <div class="faction-logo">ICA</div>
                            <h3 class="faction-name">Independent Civilian Administration</h3>
                            <div class="faction-level-container">
                                <div class="faction-level-display" id="ica-level-display">Level 0</div>
                                <input type="range" class="faction-level-slider" id="ica-slider" min="0" max="100" value="0">
                                <input type="number" class="faction-level-input" id="ica-input" min="0" max="100" value="0">
                            </div>
                            <p style="font-size: 0.9em; color: #a0aec0; text-align: center;">
                                Colonial peacekeepers and civilian administrators
                            </p>
                        </div>

                        <!-- Korolev Faction -->
                        <div class="faction-card">
                            <div class="faction-logo">KOR</div>
                            <h3 class="faction-name">Korolev Heavy Industries</h3>
                            <div class="faction-level-container">
                                <div class="faction-level-display" id="korolev-level-display">Level 0</div>
                                <input type="range" class="faction-level-slider" id="korolev-slider" min="0" max="100" value="0">
                                <input type="number" class="faction-level-input" id="korolev-input" min="0" max="100" value="0">
                            </div>
                            <p style="font-size: 0.9em; color: #a0aec0; text-align: center;">
                                Heavy industry and military equipment specialists
                            </p>
                        </div>

                        <!-- Osiris Faction -->
                        <div class="faction-card">
                            <div class="faction-logo">OSI</div>
                            <h3 class="faction-name">Osiris Research</h3>
                            <div class="faction-level-container">
                                <div class="faction-level-display" id="osiris-level-display">Level 0</div>
                                <input type="range" class="faction-level-slider" id="osiris-slider" min="0" max="100" value="0">
                                <input type="number" class="faction-level-input" id="osiris-input" min="0" max="100" value="0">
                            </div>
                            <p style="font-size: 0.9em; color: #a0aec0; text-align: center;">
                                Advanced technology and research corporation
                            </p>
                        </div>
                    </div>

                    <div style="text-align: center; margin-top: 40px;">
                        <button class="btn btn-success" id="save-factions-btn">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z"/>
                            </svg>
                            Save Faction Levels
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    
    <!-- Item Detail Modal with Weapon Attachment Editor -->
    <div id="item-detail-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="modal-item-details">
                <!-- Item details will be populated here -->
            </div>
            
            <!-- Weapon Attachment Editor (shown for weapons only) -->
            <div id="attachment-editor" class="attachment-editor" style="display: none;">
                <h3 style="color: #64ffda; margin-bottom: 20px;">Weapon Attachments</h3>
                
                <!-- Attachment Presets -->
                <div style="display: flex; gap: 15px; align-items: center; margin-bottom: 20px;">
                    <select id="attachment-preset-select" class="search-input" style="width: 200px; margin-bottom: 0;">
                        <option value="">Select Preset...</option>
                        <option value="default">Default Setup</option>
                        <option value="cqb">Close Quarters</option>
                        <option value="ranged">Long Range</option>
                        <option value="stealth">Stealth Setup</option>
                    </select>
                    <button class="btn btn-primary" id="load-preset-btn">Load</button>
                    <button class="btn btn-success" id="save-preset-btn">Save As...</button>
                </div>

                <!-- Attachment Grid -->
                <div class="attachment-grid">
                    <!-- Row 1 -->
                    <div class="attachment-slot empty" data-attachment-type="optics">
                        <div class="attachment-slot-label">Optics</div>
                        <div class="attachment-slot-icon"></div>
                        <div class="attachment-slot-name">Empty</div>
                    </div>
                    <div class="attachment-slot empty" data-attachment-type="magazine">
                        <div class="attachment-slot-label">Magazine</div>
                        <div class="attachment-slot-icon"></div>
                        <div class="attachment-slot-name">Empty</div>
                    </div>
                    <div class="attachment-slot empty" data-attachment-type="muzzle" id="muzzle-slot">
                        <div class="attachment-slot-label">Muzzle</div>
                        <div class="attachment-slot-icon"></div>
                        <div class="attachment-slot-name">Empty</div>
                    </div>
                    <div class="attachment-slot empty" data-attachment-type="stock">
                        <div class="attachment-slot-label">Stock</div>
                        <div class="attachment-slot-icon"></div>
                        <div class="attachment-slot-name">Empty</div>
                    </div>
                    
                    <!-- Row 2 -->
                    <div class="attachment-slot empty" data-attachment-type="fore-grip">
                        <div class="attachment-slot-label">Fore Grip</div>
                        <div class="attachment-slot-icon"></div>
                        <div class="attachment-slot-name">Empty</div>
                    </div>
                    <div class="attachment-slot empty" data-attachment-type="tactical">
                        <div class="attachment-slot-label">Tactical</div>
                        <div class="attachment-slot-icon"></div>
                        <div class="attachment-slot-name">Empty</div>
                    </div>
                    <div class="attachment-slot empty" data-attachment-type="ammo-converter">
                        <div class="attachment-slot-label">Ammo Converter</div>
                        <div class="attachment-slot-icon"></div>
                        <div class="attachment-slot-name">Empty</div>
                    </div>
                    <div class="attachment-slot empty" data-attachment-type="rear-grip">
                        <div class="attachment-slot-label">Rear Grip</div>
                        <div class="attachment-slot-icon"></div>
                        <div class="attachment-slot-name">Empty</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Attachment Selection Modal -->
    <div id="attachment-selection-modal" class="modal">
        <div class="modal-content">
            <span class="close" id="attachment-selection-close">&times;</span>
            <h2 style="color: #64ffda; margin-bottom: 20px;" id="attachment-selection-title">Select Attachment</h2>
            
            <div class="search-container">
                <input type="text" class="search-input" id="search-attachments" placeholder="Search attachments...">
            </div>
            
            <div class="community-grid" id="attachment-selection-grid">
                <!-- Available attachments will be populated here -->
            </div>
        </div>
    </div>

    <!-- Community Upload Modal -->
    <div id="community-upload-modal" class="modal">
        <div class="modal-content">
            <span class="close" id="community-upload-close">&times;</span>
            <h2 style="color: #64ffda; margin-bottom: 20px;" id="upload-modal-title">Upload to Community</h2>
            
            <form class="auth-form" id="community-upload-form">
                <div class="form-group">
                    <label for="upload-title">Title *</label>
                    <input type="text" id="upload-title" required maxlength="100" placeholder="Enter a descriptive title...">
                </div>
                
                <div class="form-group">
                    <label for="upload-description">Description</label>
                    <textarea id="upload-description" rows="4" maxlength="500" placeholder="Describe your build, strategy, or setup..."></textarea>
                </div>
                
                <div class="form-group">
                    <label>Tags</label>
                    <div class="tag-input-container" id="tag-input-container">
                        <input type="text" id="tag-input" placeholder="Add tags..." style="border: none; background: none; outline: none; flex: 1; color: #e0e0e0;">
                    </div>
                    <div class="tag-suggestions" id="tag-suggestions" style="display: none; position: relative; margin-top: 5px;">
                        <!-- Tag suggestions will appear here -->
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="upload-category">Category</label>
                    <select id="upload-category">
                        <option value="pvp-loadout">PvP Loadout</option>
                        <option value="pve-setup">PvE Setup</option>
                        <option value="beginner-friendly">Beginner Friendly</option>
                        <option value="resource-rich">Resource Rich</option>
                        <option value="weapon-focus">Weapon Focus</option>
                        <option value="endgame">Endgame</option>
                        <option value="stealth">Stealth</option>
                        <option value="aggressive">Aggressive</option>
                        <option value="support">Support</option>
                        <option value="exploration">Exploration</option>
                    </select>
                </div>
                
                <div style="display: flex; gap: 15px; margin-top: 30px;">
                    <button type="button" class="btn btn-danger" id="cancel-upload-btn" style="flex: 1;">Cancel</button>
                    <button type="submit" class="btn btn-success" id="submit-upload-btn" style="flex: 1;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M9,16V10H5L12,3L19,10H15V16H9M5,20V18H19V20H5Z"/>
                        </svg>
                        Upload
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Authentication Modal -->
    <div id="auth-modal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <span class="close" id="auth-close">&times;</span>
            <h2 style="color: #64ffda; text-align: center; margin-bottom: 30px;">Community Authentication</h2>
            
            <div id="auth-method-selection">
                <p style="text-align: center; margin-bottom: 30px; color: #a0aec0;">
                    Choose your preferred authentication method to access community features.
                </p>
                
                <div style="display: flex; flex-direction: column; gap: 15px;">
                    <button class="btn btn-github" id="github-auth-btn" style="justify-content: center;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                        </svg>
                        Continue with GitHub
                    </button>
                    
                    <div style="text-align: center; margin: 20px 0; color: #4a5568;">
                        <span>or</span>
                    </div>
                    
                    <button class="btn btn-primary" id="simple-auth-btn" style="justify-content: center;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z"/>
                        </svg>
                        Simple Username Login
                    </button>
                </div>
            </div>

            <!-- Simple Auth Form -->
            <div id="simple-auth-form" style="display: none;">
                <form class="auth-form">
                    <div class="form-group">
                        <label for="username-input">Username</label>
                        <input type="text" id="username-input" required minlength="3" maxlength="20" pattern="[a-zA-Z0-9_-]+" placeholder="Enter your username...">
                        <small style="color: #a0aec0; font-size: 0.8em;">
                            3-20 characters, letters, numbers, underscore, and dash only
                        </small>
                    </div>
                    
                    <div style="display: flex; gap: 15px; margin-top: 30px;">
                        <button type="button" class="btn btn-danger" id="back-to-auth-methods" style="flex: 1;">Back</button>
                        <button type="submit" class="btn btn-success" style="flex: 1;">Login</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirm-modal" class="modal">
        <div class="modal-content" style="max-width: 400px;">
            <span class="close" id="confirm-close">&times;</span>
            <div style="text-align: center;">
                <h2 style="color: #ff6b6b; margin-bottom: 20px;">Confirm Action</h2>
                <p id="confirm-message" style="margin-bottom: 30px; color: #e0e0e0;"></p>
                <div style="display: flex; gap: 15px; justify-content: center;">
                    <button class="btn btn-danger" id="confirm-yes">Confirm</button>
                    <button class="btn btn-primary" id="confirm-no">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <div class="status-bar">
        <div class="status-text" id="status-text">Auto-connecting to database...</div>
        <div class="connection-status">
            <div class="status-indicator" id="connection-indicator"></div>
            <span id="connection-text">Connecting...</span>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>